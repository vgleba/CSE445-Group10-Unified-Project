<!doctype html>
<meta charset="utf-8">
<title>ThreatNLP – TryIt</title>
<style>
    body {
        font: 14px system-ui,Segoe UI,Arial;
        margin: 24px;
        max-width: 900px
    }

    code {
        background: #f5f5f5;
        padding: 2px 4px;
        border-radius: 4px
    }

    pre {
        white-space: pre-wrap;
        border: 1px solid #ddd;
        padding: 10px;
        border-radius: 6px
    }

    .row {
        margin: 10px 0
    }

    .btn {
        padding: 6px 10px;
        border: 1px solid #888;
        border-radius: 6px;
        background: #fafafa;
        cursor: pointer
    }

        .btn:hover {
            background: #eee
        }

    textarea, input {
        width: 100%
    }
</style>

<h1>ThreatNLP – TryIt</h1>

<p>
    <b>Service URL:</b> <code id="svc"></code><br>
    <b>Method:</b> <code>POST /api/threat/nlp</code><br>
    <b>Request:</b> <code>{ text: string, lang?: string, ts?: ISO-8601 }</code><br>
    <b>Response:</b> <code>ThreatEvent[]</code> where <code>ThreatEvent = { threatType, directionDeg?, locationText?, timestamp, confidence }</code>
</p>

<div class="row">
    <label for="txt">Text</label>
    <textarea id="txt" rows="6" placeholder="Paste an alert message here..."></textarea>
</div>

<div class="row">
    <button class="btn" onclick="exampleUA()">Load UA example</button>
    <button class="btn" onclick="exampleEN()">Load EN example</button>
    <button class="btn" onclick="clearOut()">Clear</button>
</div>

<div class="row">
    <button class="btn" onclick="invoke()">Invoke</button>
</div>

<h3>Response</h3>
<pre id="out">(no response yet)</pre>

<script>
const base = location.origin;
document.getElementById('svc').textContent = base + '/api/threat/nlp';

function exampleUA(){
  document.getElementById('txt').value =
    'Зафіксовано БПЛА, рух на пн-зх від Білої Церкви. Можливе прольоти в напрямку Києва.';
}
function exampleEN(){
  document.getElementById('txt').value =
    'Missiles reported moving northwest near Vinnytsia. Possible trajectory towards Kyiv.';
}
function clearOut(){
  document.getElementById('out').textContent = '(no response yet)';
}

async function invoke(){
  const body = { text: document.getElementById('txt').value };
  const r = await fetch(base + '/api/threat/nlp', {
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify(body)
  });
  const text = await r.text();
  document.getElementById('out').textContent =
    'HTTP ' + r.status + '\n\n' + pretty(text);
}

function pretty(t){
  try { return JSON.stringify(JSON.parse(t), null, 2); }
  catch(e){ return t; }
}
</script>
