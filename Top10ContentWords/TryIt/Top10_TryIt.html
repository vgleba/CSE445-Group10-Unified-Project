<!doctype html>
<meta charset="utf-8">
<title>Top10ContentWords – TryIt (SOAP)</title>
<style>
    body {
        font: 14px system-ui,Segoe UI,Arial;
        margin: 24px;
        max-width: 900px
    }

    code {
        background: #f5f5f5;
        padding: 2px 4px;
        border-radius: 4px
    }

    pre {
        white-space: pre-wrap;
        border: 1px solid #ddd;
        padding: 10px;
        border-radius: 6px
    }

    .row {
        margin: 10px 0
    }

    .btn {
        padding: 6px 10px;
        border: 1px solid #888;
        border-radius: 6px;
        background: #fafafa;
        cursor: pointer
    }

        .btn:hover {
            background: #eee
        }

    textarea, input {
        width: 100%
    }
</style>

<h1>Top10ContentWords – TryIt</h1>

<p>
    <b>Service URL:</b> <code id="svc"></code><br>
    <b>Operation:</b> <code>Top10ContentWords(inputOrUrl:string) → string[10]</code><br>
    <b>Note:</b> If you pass a URL, the service calls <code>WebDownload</code> (raw=false) and then performs
    <i>strip tags/attrs → remove stopwords → stem → count → sort → top-10</i>.
</p>

<div class="row">
    <label>Input (plain text or URL starting with http/https)</label>
    <textarea id="inp" rows="6" placeholder="Paste text or enter https://example.org/"></textarea>
</div>

<div class="row">
    <button class="btn" onclick="exText()">Load text example</button>
    <button class="btn" onclick="exUrl()">Load URL example</button>
    <button class="btn" onclick="clearOut()">Clear</button>
</div>

<div class="row">
    <button class="btn" onclick="invoke()">Invoke</button>
</div>

<h3>Response</h3>
<pre id="out">(no response yet)</pre>

<script>
// If you changed the service/contract namespaces, update soapNs and soapAction accordingly.
const base = location.origin;
const endpoint = base + '/Services/TextAnalytics.svc';
const soapNs = 'http://tempuri.org/';
const soapAction = 'http://tempuri.org/ITextAnalytics/Top10ContentWords';

document.getElementById('svc').textContent = endpoint;

function exText(){
  document.getElementById('inp').value =
    "missiles missile missile drones drone drone artillery artillery strike strike strike";
}
function exUrl(){ document.getElementById('inp').value = "https://example.org/"; }
function clearOut(){ document.getElementById('out').textContent='(no response yet)'; }

function xmlEscape(s){ return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"); }

async function invoke(){
  const val = document.getElementById('inp').value;
  const soap =
`<?xml version="1.0" encoding="utf-8"?>
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Body>
    <Top10ContentWords xmlns="${soapNs}">
      <inputOrUrl>${xmlEscape(val)}</inputOrUrl>
    </Top10ContentWords>
  </s:Body>
</s:Envelope>`;

  const r = await fetch(endpoint, {
    method: 'POST',
    headers: {
      'Content-Type': 'text/xml; charset=utf-8',
      'SOAPAction': soapAction
    },
    body: soap
  });
  const xml = await r.text();
  const items = [...xml.matchAll(/<string[^>]*>(.*?)<\/string>/g)].map(m => m[1]);
  const body = items.length ? JSON.stringify(items, null, 2) : xml;
  document.getElementById('out').textContent = 'HTTP ' + r.status + '\n\n' + body;
}
</script>
